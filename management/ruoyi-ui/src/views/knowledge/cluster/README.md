# 知识库聚类分析功能说明

## 功能概述

知识库聚类分析功能提供了对知识库内容的深度数据分析和可视化展示，帮助用户更好地理解和管理知识库数据。

## 主要功能

### 1. 统计概览

- **聚类数量**: 显示当前知识库中的聚类总数
- **文档总数**: 展示知识库中的文档总量
- **标签总数**: 统计所有使用的标签数量
- **平均相似度**: 显示文档间的平均相似度百分比

### 2. 数据可视化

#### 聚类分布图 (散点图)

- 使用二维散点图展示知识库内容的聚类分布
- 不同颜色代表不同的聚类
- 点的大小反映相似度高低
- 支持鼠标悬停查看详细信息

#### 内容类型分布 (饼图)

- 展示不同内容类型的比例分布
- 包括 Web、RSS、Manual 等类型
- 直观显示各类型的占比情况

#### 关键词云图

- 基于标签和标题生成词云
- 词的大小反映出现频率
- 支持动态颜色渲染
- 最多显示 50 个高频词汇

#### 内容增长趋势 (折线图)

- 支持 7 天、30 天、90 天时间范围选择
- 显示每日新增文档数量趋势
- 平滑曲线展示增长模式

### 3. 聚类详情分析

#### 聚类列表表格

- **聚类 ID**: 唯一标识符，带颜色标签
- **聚类名称**: 基于内容类型自动生成
- **文档数量**: 该聚类包含的文档数量
- **平均相似度**: 进度条显示相似度百分比
- **关键词**: 该聚类的主要标签
- **内容类型**: 包含的内容类型列表

#### 聚类详情对话框

- 点击"查看详情"可查看聚类的具体信息
- 显示聚类基本信息和包含的文档列表
- 每个文档显示标题、类型、相似度和标签

### 4. 交互功能

- **刷新按钮**: 各图表支持独立刷新
- **时间周期选择**: 趋势图支持不同时间范围
- **导出报告**: 支持导出分析报告（开发中）
- **响应式设计**: 适配不同屏幕尺寸

## 技术实现

### 前端技术栈

- **Vue.js 2.x**: 主框架
- **Element UI**: UI 组件库
- **ECharts 5.x**: 图表可视化
- **echarts-wordcloud**: 词云插件

### 后端 API 接口

- `GET /api/knowledge-content/cluster-analysis`: 获取聚类分析数据
- `GET /api/knowledge-content/cluster-stats`: 获取聚类统计信息
- `GET /api/knowledge-content/word-cloud`: 获取词云数据
- `GET /api/knowledge-content/type-distribution`: 获取类型分布
- `GET /api/knowledge-content/tag-analysis`: 获取标签分析
- `GET /api/knowledge-content/time-trend`: 获取时间趋势

### 聚类算法

目前使用基于内容类型的简单聚类算法，未来可扩展为：

- K-means 聚类
- 层次聚类
- 基于密度的聚类
- 语义相似度聚类

## 使用说明

### 访问路径

1. 登录 RuoYi 管理系统
2. 导航至 **知识库管理** > **聚类分析**
3. 页面自动加载并显示分析结果

### 操作指南

1. **查看统计**: 页面顶部显示关键统计指标
2. **分析图表**: 四个图表提供不同维度的数据分析
3. **详情查看**: 点击表格中的"查看详情"按钮查看聚类详情
4. **数据刷新**: 使用各图表的刷新按钮更新数据
5. **时间筛选**: 在趋势图中选择不同的时间范围

### 权限要求

- 需要 `knowledge:cluster:query` 权限查看聚类分析
- 需要 `knowledge:cluster:export` 权限导出报告

## 数据说明

### 聚类逻辑

- 当前基于内容类型进行聚类分组
- 每个内容类型形成一个聚类
- 相似度基于标签重叠度计算

### 词云生成

- 提取所有标签和标题关键词
- 统计词频并排序
- 过滤长度小于 2 的词汇
- 限制显示前 50 个高频词

### 趋势分析

- 按采集时间统计每日新增文档
- 支持 7 天、30 天、90 天三个时间范围
- 自动填充无数据日期为 0

## 扩展建议

### 功能增强

1. **高级聚类算法**: 集成机器学习聚类算法
2. **相似度计算**: 基于内容语义的相似度计算
3. **交互式筛选**: 支持按聚类、类型、时间筛选
4. **报告导出**: PDF/Excel 格式的详细报告
5. **实时更新**: WebSocket 实时数据更新

### 性能优化

1. **数据缓存**: Redis 缓存分析结果
2. **异步计算**: 后台异步执行复杂聚类算法
3. **分页加载**: 大数据集的分页处理
4. **图表优化**: 虚拟滚动和数据采样

## 故障排除

### 常见问题

1. **图表不显示**: 检查 ECharts 是否正确加载
2. **数据为空**: 确认知识库中有数据
3. **API 错误**: 检查后端服务状态
4. **权限不足**: 确认用户具有相应权限

### 调试方法

1. 打开浏览器开发者工具
2. 查看 Console 中的错误信息
3. 检查 Network 面板的 API 请求
4. 确认后端服务日志

---

_该功能持续优化中，如有问题请联系开发团队。_
