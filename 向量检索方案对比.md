# å‘é‡æ£€ç´¢æ–¹æ¡ˆå¿«é€Ÿå¯¹æ¯”

## ğŸ¯ ä¸€å¥è¯æ€»ç»“

| æ–¹æ¡ˆ            | ä¸€å¥è¯æ€»ç»“                              |
| --------------- | --------------------------------------- |
| **å½“å‰æ–¹æ¡ˆ**    | ç®€å•å¤Ÿç”¨ï¼Œé›¶ä¾èµ–ï¼Œé€‚åˆä¸‡çº§æ•°æ®          |
| **faiss4j**     | å¼ºå¤§ä½†é‡ï¼Œéœ€è¦ C++ ä¾èµ–ï¼Œé€‚åˆç™¾ä¸‡çº§ä»¥ä¸Š |
| **Lucene 9.0+** | å…¨èƒ½ä½†å¤æ‚ï¼Œé€‚åˆéœ€è¦å…¨æ–‡æ£€ç´¢çš„åœºæ™¯      |

---

## ğŸ“Š è¯¦ç»†å¯¹æ¯”çŸ©é˜µ

### æ ¸å¿ƒæŒ‡æ ‡å¯¹æ¯”

| æŒ‡æ ‡                     | å½“å‰æ–¹æ¡ˆ  | faiss4j     | Lucene 9.0+ |
| ------------------------ | --------- | ----------- | ----------- |
| **ä»£ç è¡Œæ•°**             | ~300 è¡Œ   | ~1000+ è¡Œ   | ~800+ è¡Œ    |
| **ä¾èµ–å¤§å°**             | 0 MB      | ~50 MB      | ~10 MB      |
| **å¯åŠ¨æ—¶é—´**             | < 1s      | ~3-5s       | ~2-3s       |
| **å†…å­˜å ç”¨ï¼ˆ1 ä¸‡æ¡ï¼‰**   | ~25 MB    | ~30 MB      | ~50 MB      |
| **æœç´¢å»¶è¿Ÿï¼ˆ1 ä¸‡æ¡ï¼‰**   | 50-100 ms | 1-5 ms      | 10-20 ms    |
| **æœç´¢å»¶è¿Ÿï¼ˆ100 ä¸‡æ¡ï¼‰** | 5-10 s    | 10-50 ms    | 100-200 ms  |
| **è·¨å¹³å°éƒ¨ç½²**           | âœ… å®Œç¾   | âš ï¸ éœ€è¦ç¼–è¯‘ | âœ… å®Œç¾     |
| **Docker é•œåƒå¢é‡**      | 0 MB      | +80 MB      | +20 MB      |
| **å­¦ä¹ æ—¶é—´**             | 1 å¤©      | 1-2 å‘¨      | 1 å‘¨        |

### åŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½                | å½“å‰æ–¹æ¡ˆ         | faiss4j         | Lucene 9.0+   |
| ------------------- | ---------------- | --------------- | ------------- |
| **å‘é‡å­˜å‚¨**        | âœ…               | âœ…              | âœ…            |
| **ä½™å¼¦ç›¸ä¼¼åº¦**      | âœ…               | âœ…              | âœ…            |
| **æ¬§æ°è·ç¦»**        | âŒ               | âœ…              | âœ…            |
| **å†…ç§¯ç›¸ä¼¼åº¦**      | âŒ               | âœ…              | âœ…            |
| **ç²¾ç¡®æ£€ç´¢**        | âœ…               | âœ…              | âœ…            |
| **è¿‘ä¼¼æ£€ç´¢ï¼ˆANNï¼‰** | âŒ               | âœ… (IVF/HNSW)   | âœ… (HNSW)     |
| **å‘é‡é‡åŒ–**        | âŒ               | âœ… (PQ/SQ)      | âŒ            |
| **GPU åŠ é€Ÿ**        | âŒ               | âœ…              | âŒ            |
| **å…¨æ–‡æ£€ç´¢**        | âŒ               | âŒ              | âœ…            |
| **æ··åˆæ£€ç´¢**        | âŒ               | âŒ              | âœ…            |
| **æŒä¹…åŒ–**          | âœ… (Java åºåˆ—åŒ–) | âœ… (äºŒè¿›åˆ¶)     | âœ… (ç´¢å¼•æ–‡ä»¶) |
| **åˆ†å¸ƒå¼**          | âŒ               | âš ï¸ éœ€è¦è‡ªå·±å®ç° | âœ… (é€šè¿‡ ES)  |

### å¼€å‘ä½“éªŒå¯¹æ¯”

| ç»´åº¦           | å½“å‰æ–¹æ¡ˆ        | faiss4j                | Lucene 9.0+     |
| -------------- | --------------- | ---------------------- | --------------- |
| **é…ç½®å¤æ‚åº¦** | â­ é›¶é…ç½®       | â­â­â­â­â­ å¤æ‚        | â­â­â­â­ è¾ƒå¤æ‚ |
| **è°ƒè¯•éš¾åº¦**   | â­ å®¹æ˜“         | â­â­â­â­â­ å›°éš¾ï¼ˆJNIï¼‰ | â­â­â­ ä¸­ç­‰     |
| **æ–‡æ¡£è´¨é‡**   | â­â­â­ è‡ªå†™æ–‡æ¡£ | â­â­â­ ä¸­æ–‡å°‘          | â­â­â­â­ ä¸°å¯Œ   |
| **ç¤¾åŒºæ´»è·ƒåº¦** | âŒ æ—            | â­â­â­ ä¸­ç­‰            | â­â­â­â­â­ æ´»è·ƒ |
| **é”™è¯¯ä¿¡æ¯**   | â­â­â­â­â­ æ¸…æ™° | â­â­ éš¾æ‡‚              | â­â­â­â­ æ¸…æ™°   |
| **IDE æ”¯æŒ**   | â­â­â­â­â­ å®Œç¾ | â­â­â­ ä¸€èˆ¬            | â­â­â­â­ è‰¯å¥½   |

### éƒ¨ç½²è¿ç»´å¯¹æ¯”

| ç»´åº¦         | å½“å‰æ–¹æ¡ˆ   | faiss4j      | Lucene 9.0+ |
| ------------ | ---------- | ------------ | ----------- |
| **æ„å»ºæ—¶é—´** | < 10s      | ~5 åˆ†é’Ÿ      | ~30s        |
| **éƒ¨ç½²æ­¥éª¤** | 1 æ­¥       | 5+ æ­¥        | 3 æ­¥        |
| **ç¯å¢ƒä¾èµ–** | ä»… JVM     | JVM + C++ åº“ | ä»… JVM      |
| **ç›‘æ§æŒ‡æ ‡** | ç®€å•       | å¤æ‚         | ä¸­ç­‰        |
| **æ—¥å¿—è°ƒè¯•** | å®¹æ˜“       | å›°éš¾         | ä¸­ç­‰        |
| **æ•…éšœæ’æŸ¥** | å®¹æ˜“       | å›°éš¾         | ä¸­ç­‰        |
| **ç‰ˆæœ¬å‡çº§** | æ— ä¾èµ–å†²çª | å¯èƒ½å†²çª     | å¯èƒ½å†²çª    |

---

## ğŸ’° æˆæœ¬åˆ†æ

### å¼€å‘æˆæœ¬

| é˜¶æ®µ         | å½“å‰æ–¹æ¡ˆ   | faiss4j        | Lucene 9.0+    |
| ------------ | ---------- | -------------- | -------------- |
| **å­¦ä¹ æˆæœ¬** | 0.5 äººå¤©   | 5-10 äººå¤©      | 3-5 äººå¤©       |
| **å¼€å‘æˆæœ¬** | 2 äººå¤©     | 10-15 äººå¤©     | 8-10 äººå¤©      |
| **æµ‹è¯•æˆæœ¬** | 1 äººå¤©     | 5 äººå¤©         | 3 äººå¤©         |
| **æ–‡æ¡£æˆæœ¬** | 0.5 äººå¤©   | 2 äººå¤©         | 1 äººå¤©         |
| **æ€»è®¡**     | **4 äººå¤©** | **22-32 äººå¤©** | **15-19 äººå¤©** |

### è¿ç»´æˆæœ¬ï¼ˆå¹´ï¼‰

| é¡¹ç›®           | å½“å‰æ–¹æ¡ˆ   | faiss4j     | Lucene 9.0+ |
| -------------- | ---------- | ----------- | ----------- |
| **æœåŠ¡å™¨æˆæœ¬** | Â¥3,000     | Â¥8,000      | Â¥6,000      |
| **è¿ç»´äººåŠ›**   | Â¥5,000     | Â¥30,000     | Â¥20,000     |
| **ç›‘æ§å‘Šè­¦**   | Â¥1,000     | Â¥5,000      | Â¥3,000      |
| **åŸ¹è®­æˆæœ¬**   | Â¥0         | Â¥10,000     | Â¥5,000      |
| **æ€»è®¡**       | **Â¥9,000** | **Â¥53,000** | **Â¥34,000** |

---

## ğŸ¯ é€‰å‹å†³ç­–æ ‘

```
æ•°æ®é‡ < 1 ä¸‡ï¼Ÿ
â”œâ”€ æ˜¯ â†’ å½“å‰æ–¹æ¡ˆï¼ˆæš´åŠ›æœç´¢ï¼‰
â””â”€ å¦ â†’ æ•°æ®é‡ < 10 ä¸‡ï¼Ÿ
    â”œâ”€ æ˜¯ â†’ å½“å‰æ–¹æ¡ˆ or LangChain4j å†…ç½®å‘é‡å­˜å‚¨
    â””â”€ å¦ â†’ æ•°æ®é‡ < 100 ä¸‡ï¼Ÿ
        â”œâ”€ æ˜¯ â†’ Lucene 9.0+ (å¦‚æœéœ€è¦å…¨æ–‡æ£€ç´¢)
        â”‚       or Milvus/Qdrant (çº¯å‘é‡)
        â””â”€ å¦ â†’ faiss4j + åˆ†å¸ƒå¼æ¶æ„
                or äº‘æœåŠ¡ï¼ˆPinecone/Weaviateï¼‰
```

---

## âš¡ æ€§èƒ½åŸºå‡†æµ‹è¯•ï¼ˆé¢„ä¼°ï¼‰

### ç´¢å¼•æ„å»ºæ—¶é—´

| æ•°æ®é‡    | å½“å‰æ–¹æ¡ˆ | faiss4j (Flat) | faiss4j (IVF) | Lucene (HNSW) |
| --------- | -------- | -------------- | ------------- | ------------- |
| 1,000     | 0.5s     | 1s             | 2s            | 2s            |
| 10,000    | 3s       | 5s             | 10s           | 15s           |
| 100,000   | 30s      | 50s            | 2 åˆ†é’Ÿ        | 3 åˆ†é’Ÿ        |
| 1,000,000 | 5 åˆ†é’Ÿ   | 8 åˆ†é’Ÿ         | 20 åˆ†é’Ÿ       | 30 åˆ†é’Ÿ       |

### å•æ¬¡æŸ¥è¯¢å»¶è¿Ÿ

| æ•°æ®é‡    | å½“å‰æ–¹æ¡ˆ | faiss4j (Flat) | faiss4j (IVF) | Lucene (HNSW) |
| --------- | -------- | -------------- | ------------- | ------------- |
| 1,000     | 5ms      | 1ms            | 0.5ms         | 1ms           |
| 10,000    | 50ms     | 5ms            | 2ms           | 5ms           |
| 100,000   | 500ms    | 50ms           | 5ms           | 20ms          |
| 1,000,000 | 5s       | 500ms          | 10ms          | 50ms          |

### å†…å­˜å ç”¨

| æ•°æ®é‡    | å½“å‰æ–¹æ¡ˆ | faiss4j (Flat) | faiss4j (PQ) | Lucene |
| --------- | -------- | -------------- | ------------ | ------ |
| 1,000     | 2 MB     | 3 MB           | 1 MB         | 5 MB   |
| 10,000    | 20 MB    | 30 MB          | 10 MB        | 50 MB  |
| 100,000   | 200 MB   | 300 MB         | 80 MB        | 400 MB |
| 1,000,000 | 2 GB     | 3 GB           | 800 MB       | 4 GB   |

---

## ğŸš¦ æœ€ç»ˆæ¨è

### âœ… ä½¿ç”¨å½“å‰æ–¹æ¡ˆï¼ˆè‡ªç ”ï¼‰çš„åœºæ™¯

- æ•°æ®é‡ < 1 ä¸‡æ¡ï¼ˆâœ… **å½“å‰é¡¹ç›®**ï¼‰
- å›¢é˜Ÿè§„æ¨¡ < 5 äººï¼ˆâœ… **å½“å‰é¡¹ç›®**ï¼‰
- å¿«é€Ÿè¿­ä»£ï¼Œéœ€æ±‚å˜åŒ–å¿«ï¼ˆâœ… **å½“å‰é¡¹ç›®**ï¼‰
- å¯¹å»¶è¿Ÿè¦æ±‚ä¸ä¸¥æ ¼ï¼ˆ< 500ms å¯æ¥å—ï¼‰ï¼ˆâœ… **å½“å‰é¡¹ç›®**ï¼‰
- ä¸æƒ³å¼•å…¥å¤æ‚ä¾èµ–ï¼ˆâœ… **å½“å‰é¡¹ç›®**ï¼‰

### âš ï¸ ä½¿ç”¨ Lucene 9.0+ çš„åœºæ™¯

- éœ€è¦å…¨æ–‡æ£€ç´¢ + å‘é‡æ£€ç´¢
- æ•°æ®é‡ 10 ä¸‡ - 100 ä¸‡
- éœ€è¦æŒä¹…åŒ–å’Œå´©æºƒæ¢å¤
- å·²ç»æœ‰ Lucene/ES æŠ€æœ¯æ ˆ

### âš ï¸ ä½¿ç”¨ faiss4j çš„åœºæ™¯

- æ•°æ®é‡ > 100 ä¸‡æ¡
- å¯¹æŸ¥è¯¢å»¶è¿Ÿè¦æ±‚æé«˜ï¼ˆ< 10msï¼‰
- éœ€è¦ GPU åŠ é€Ÿ
- å›¢é˜Ÿæœ‰ C++ å’Œ JNI ç»éªŒ

### ğŸ† æ¨èæ›¿ä»£æ–¹æ¡ˆ

å¦‚æœæœªæ¥éœ€è¦å‡çº§ï¼Œæ¨èï¼š

1. **Milvus**ï¼ˆäº‘åŸç”Ÿå‘é‡æ•°æ®åº“ï¼‰
2. **Qdrant**ï¼ˆRust å®ç°ï¼Œæ€§èƒ½å¥½ï¼‰
3. **Weaviate**ï¼ˆå†…ç½®å‘é‡åŒ–ï¼‰
4. **Pinecone**ï¼ˆæ‰˜ç®¡æœåŠ¡ï¼Œå…è¿ç»´ï¼‰

---

## ğŸ“š ä»£ç ç¤ºä¾‹å¯¹æ¯”

### å½“å‰æ–¹æ¡ˆ

```java
// ç®€å•æ¸…æ™°
vectorStore.put(id, vector);
List<Result> results = faissVectorStore.searchSimilar(queryVector, 10);
```

### faiss4j

```java
// å¤æ‚éš¾æ‡‚
IndexFlatL2 index = new IndexFlatL2(dimension);
index.add(vectors);  // éœ€è¦ native è°ƒç”¨
float[] distances = new float[k];
long[] labels = new long[k];
index.search(1, queryVector, k, distances, labels);
// æ‰‹åŠ¨è§£æç»“æœ...
```

### Lucene 9.0+

```java
// ä¸­ç­‰å¤æ‚
Directory dir = FSDirectory.open(path);
IndexWriter writer = new IndexWriter(dir, config);
Document doc = new Document();
doc.add(new KnnVectorField("vector", vector, COSINE));
writer.addDocument(doc);
writer.commit();
// æœç´¢éœ€è¦å¦ä¸€å¥— API...
```

---

## ğŸ“ æ€»ç»“

| æ–¹æ¡ˆ            | é€‚ç”¨åœºæ™¯               | æ ¸å¿ƒä¼˜åŠ¿               | ä¸»è¦åŠ£åŠ¿             |
| --------------- | ---------------------- | ---------------------- | -------------------- |
| **å½“å‰æ–¹æ¡ˆ**    | å°å‹é¡¹ç›®ï¼ˆ< 1 ä¸‡æ•°æ®ï¼‰ | ç®€å•ã€é›¶ä¾èµ–ã€å¿«é€Ÿå¼€å‘ | ä¸æ”¯æŒå¤§è§„æ¨¡æ•°æ®     |
| **faiss4j**     | å¤§è§„æ¨¡æ£€ç´¢ï¼ˆ> 100 ä¸‡ï¼‰ | æè‡´æ€§èƒ½ã€GPU åŠ é€Ÿ     | éƒ¨ç½²å¤æ‚ã€å­¦ä¹ æˆæœ¬é«˜ |
| **Lucene 9.0+** | æ··åˆæ£€ç´¢åœºæ™¯           | å…¨æ–‡+å‘é‡ã€ç”Ÿæ€æˆç†Ÿ    | é…ç½®å¤æ‚ã€å†…å­˜å ç”¨é«˜ |

---

**ç»“è®ºï¼šå¯¹äºå½“å‰é¡¹ç›®ï¼Œè‡ªç ”æ–¹æ¡ˆæ˜¯æœ€ä¼˜é€‰æ‹©ã€‚ä¿æŒç®€å•ï¼Œç­‰çœŸæ­£éœ€è¦æ—¶å†å‡çº§ã€‚**

_"Premature optimization is the root of all evil." â€” Donald Knuth_
